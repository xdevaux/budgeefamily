{% extends "base.html" %}

{% block title %}Ajouter une catégorie - Administration{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="mb-4">
                <h1 class="h3"><i class="fas fa-folder-plus"></i> Ajouter une catégorie par défaut</h1>
            </div>

            <div class="card">
                <div class="card-body">
                    <form method="POST">
                        <div class="mb-3">
                            <label for="name" class="form-label">Nom <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>

                        <div class="mb-3">
                            <label for="description" class="form-label">Description</label>
                            <textarea class="form-control" id="description" name="description" rows="3"></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="color" class="form-label">Couleur</label>
                                <input type="color" class="form-control form-control-color" id="color" name="color" value="#6c757d">
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="icon" class="form-label">Icône (Font Awesome)</label>
                                <div class="input-group">
                                    <span class="input-group-text" id="iconPreview">
                                        <i class="fas fa-question-circle text-muted"></i>
                                    </span>
                                    <input type="text" class="form-control" id="icon" name="icon" placeholder="fas fa-folder" readonly>
                                    <button class="btn btn-outline-secondary" type="button" data-bs-toggle="modal" data-bs-target="#iconPickerModal">
                                        <i class="fas fa-icons"></i> Choisir
                                    </button>
                                </div>
                                <small class="text-muted">Cliquez sur "Choisir" pour sélectionner une icône</small>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="logo_url" class="form-label">URL du logo</label>
                            <input type="url" class="form-control" id="logo_url" name="logo_url" placeholder="https://example.com/logo.png">
                        </div>

                        <div class="mb-3">
                            <label for="website_url" class="form-label">URL du site web</label>
                            <input type="url" class="form-control" id="website_url" name="website_url" placeholder="https://example.com">
                        </div>

                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="is_active" name="is_active" checked>
                            <label class="form-check-label" for="is_active">
                                Catégorie active
                            </label>
                        </div>

                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Créer la catégorie
                            </button>
                            <a href="{{ url_for('admin.categories_list') }}" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Annuler
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de sélection d'icône -->
<div class="modal fade" id="iconPickerModal" tabindex="-1" aria-labelledby="iconPickerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="iconPickerModalLabel">Sélectionnez une icône</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <input type="text" class="form-control" id="iconSearch" placeholder="Rechercher une icône...">
                </div>
                <div class="row g-2" id="iconGrid">
                    <!-- Les icônes seront générées par JavaScript -->
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// Liste d'icônes Font Awesome populaires pour les catégories
const icons = [
    'fa-folder', 'fa-video', 'fa-music', 'fa-film', 'fa-gamepad', 'fa-newspaper',
    'fa-cloud', 'fa-server', 'fa-database', 'fa-laptop', 'fa-mobile', 'fa-desktop',
    'fa-book', 'fa-graduation-cap', 'fa-briefcase', 'fa-chart-line', 'fa-shopping-cart',
    'fa-store', 'fa-home', 'fa-building', 'fa-hospital', 'fa-heart', 'fa-medkit',
    'fa-utensils', 'fa-coffee', 'fa-pizza-slice', 'fa-wine-glass', 'fa-beer',
    'fa-car', 'fa-bus', 'fa-plane', 'fa-train', 'fa-bicycle', 'fa-motorcycle',
    'fa-dumbbell', 'fa-running', 'fa-basketball-ball', 'fa-football-ball', 'fa-baseball-ball',
    'fa-tv', 'fa-headphones', 'fa-camera', 'fa-microphone', 'fa-photo-video',
    'fa-envelope', 'fa-phone', 'fa-comment', 'fa-comments', 'fa-bell',
    'fa-calendar', 'fa-clock', 'fa-bookmark', 'fa-tag', 'fa-tags',
    'fa-globe', 'fa-wifi', 'fa-shield-alt', 'fa-lock', 'fa-key',
    'fa-wrench', 'fa-tools', 'fa-cog', 'fa-paint-brush', 'fa-palette',
    'fa-lightbulb', 'fa-bolt', 'fa-fire', 'fa-sun', 'fa-moon',
    'fa-star', 'fa-gift', 'fa-trophy', 'fa-medal', 'fa-award',
    'fa-chart-pie', 'fa-chart-bar', 'fa-chart-area', 'fa-percent', 'fa-dollar-sign',
    'fa-euro-sign', 'fa-pound-sign', 'fa-yen-sign', 'fa-wallet', 'fa-credit-card',
    'fa-university', 'fa-landmark', 'fa-money-bill', 'fa-coins', 'fa-piggy-bank',
    'fa-box', 'fa-boxes', 'fa-archive', 'fa-warehouse', 'fa-truck',
    'fa-microscope', 'fa-flask', 'fa-atom', 'fa-dna', 'fa-brain',
    'fa-leaf', 'fa-tree', 'fa-seedling', 'fa-recycle', 'fa-paw'
];

// Générer la grille d'icônes
function generateIconGrid(filterText = '') {
    const iconGrid = document.getElementById('iconGrid');
    iconGrid.innerHTML = '';

    const filteredIcons = icons.filter(icon =>
        icon.toLowerCase().includes(filterText.toLowerCase())
    );

    filteredIcons.forEach(icon => {
        const col = document.createElement('div');
        col.className = 'col-6 col-md-3 col-lg-2';

        const iconBtn = document.createElement('button');
        iconBtn.type = 'button';
        iconBtn.className = 'btn btn-outline-secondary w-100 p-3 icon-selector-btn';
        iconBtn.innerHTML = `<i class="fas ${icon} fa-2x mb-2"></i><br><small>${icon.replace('fa-', '')}</small>`;
        iconBtn.onclick = function() {
            selectIcon(`fas ${icon}`);
        };

        col.appendChild(iconBtn);
        iconGrid.appendChild(col);
    });

    if (filteredIcons.length === 0) {
        iconGrid.innerHTML = '<div class="col-12 text-center text-muted">Aucune icône trouvée</div>';
    }
}

// Sélectionner une icône
function selectIcon(iconClass) {
    document.getElementById('icon').value = iconClass;

    // Mettre à jour la prévisualisation
    const iconPreview = document.getElementById('iconPreview');
    iconPreview.innerHTML = `<i class="${iconClass}"></i>`;

    const modal = bootstrap.Modal.getInstance(document.getElementById('iconPickerModal'));
    modal.hide();
}

// Recherche d'icônes
document.addEventListener('DOMContentLoaded', function() {
    generateIconGrid();

    const searchInput = document.getElementById('iconSearch');
    searchInput.addEventListener('input', function() {
        generateIconGrid(this.value);
    });
});
</script>

<style>
.icon-selector-btn {
    transition: all 0.2s;
}

.icon-selector-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

#iconGrid {
    max-height: 400px;
    overflow-y: auto;
}
</style>
{% endblock %}
